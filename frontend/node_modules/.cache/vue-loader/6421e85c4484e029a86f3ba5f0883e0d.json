{"remainingRequest":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lq/ifb/src/eshop/frontend/src/components/files/Editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/lq/ifb/src/eshop/frontend/src/components/files/Editor.vue","mtime":1583132470972},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IHsgZmlsZXMgYXMgYXBpIH0gZnJvbSAnQC9hcGknCmltcG9ydCBidXR0b25zIGZyb20gJ0AvdXRpbHMvYnV0dG9ucycKCmltcG9ydCBhY2UgZnJvbSAnYWNlLWJ1aWxkcy9zcmMtbWluLW5vY29uZmxpY3QvYWNlLmpzJwppbXBvcnQgbW9kZWxpc3QgZnJvbSAnYWNlLWJ1aWxkcy9zcmMtbWluLW5vY29uZmxpY3QvZXh0LW1vZGVsaXN0LmpzJwppbXBvcnQgJ2FjZS1idWlsZHMvd2VicGFjay1yZXNvbHZlcicKaW1wb3J0IHsgdGhlbWUgfSBmcm9tICdAL3V0aWxzL2NvbnN0YW50cycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZWRpdG9yJywKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoWydyZXEnXSkKICB9LAogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7fQogIH0sCiAgY3JlYXRlZCAoKSB7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5RXZlbnQpCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZS1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuc2F2ZSkKICB9LAogIGJlZm9yZURlc3Ryb3kgKCkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleUV2ZW50KQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmUtYnV0dG9uJykucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNhdmUpCiAgICB0aGlzLmVkaXRvci5kZXN0cm95KCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7CiAgICBjb25zdCBmaWxlQ29udGVudCA9IHRoaXMucmVxLmNvbnRlbnQgfHwgJyc7CgogICAgdGhpcy5lZGl0b3IgPSBhY2UuZWRpdCgnZWRpdG9yJywgewogICAgICBtYXhMaW5lczogSW5maW5pdHksCiAgICAgIG1pbkxpbmVzOiAyMCwKICAgICAgdmFsdWU6IGZpbGVDb250ZW50LAogICAgICBzaG93UHJpbnRNYXJnaW46IGZhbHNlLAogICAgICByZWFkT25seTogdGhpcy5yZXEudHlwZSA9PT0gJ3RleHRJbW11dGFibGUnLAogICAgICB0aGVtZTogJ2FjZS90aGVtZS9jaHJvbWUnLAogICAgICBtb2RlOiBtb2RlbGlzdC5nZXRNb2RlRm9yUGF0aCh0aGlzLnJlcS5uYW1lKS5tb2RlLAogICAgICB3cmFwOiB0cnVlCiAgICB9KQoKICAgIGlmICh0aGVtZSA9PSAnZGFyaycpIHsKICAgICAgdGhpcy5lZGl0b3Iuc2V0VGhlbWUoImFjZS90aGVtZS90d2lsaWdodCIpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAga2V5RXZlbnQgKGV2ZW50KSB7CiAgICAgIGlmICghZXZlbnQuY3RybEtleSAmJiAhZXZlbnQubWV0YUtleSkgewogICAgICAgIHJldHVybgogICAgICB9CgogICAgICBpZiAoU3RyaW5nLmZyb21DaGFyQ29kZShldmVudC53aGljaCkudG9Mb3dlckNhc2UoKSAhPT0gJ3MnKSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCkKICAgICAgdGhpcy5zYXZlKCkKICAgIH0sCiAgICBhc3luYyBzYXZlICgpIHsKICAgICAgY29uc3QgYnV0dG9uID0gJ3NhdmUnCiAgICAgIGJ1dHRvbnMubG9hZGluZygnc2F2ZScpCgogICAgICB0cnkgewogICAgICAgIGF3YWl0IGFwaS5wdXQodGhpcy4kcm91dGUucGF0aCwgdGhpcy5lZGl0b3IuZ2V0VmFsdWUoKSkKICAgICAgICBidXR0b25zLnN1Y2Nlc3MoYnV0dG9uKQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgYnV0dG9ucy5kb25lKGJ1dHRvbikKICAgICAgICB0aGlzLiRzaG93RXJyb3IoZSkKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["Editor.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Editor.vue","sourceRoot":"src/components/files","sourcesContent":["<template>\n  <form id=\"editor\"></form>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { files as api } from '@/api'\nimport buttons from '@/utils/buttons'\n\nimport ace from 'ace-builds/src-min-noconflict/ace.js'\nimport modelist from 'ace-builds/src-min-noconflict/ext-modelist.js'\nimport 'ace-builds/webpack-resolver'\nimport { theme } from '@/utils/constants'\n\nexport default {\n  name: 'editor',\n  computed: {\n    ...mapState(['req'])\n  },\n  data: function () {\n    return {}\n  },\n  created () {\n    window.addEventListener('keydown', this.keyEvent)\n    document.getElementById('save-button').addEventListener('click', this.save)\n  },\n  beforeDestroy () {\n    window.removeEventListener('keydown', this.keyEvent)\n    document.getElementById('save-button').removeEventListener('click', this.save)\n    this.editor.destroy();\n  },\n  mounted: function () {\n    const fileContent = this.req.content || '';\n\n    this.editor = ace.edit('editor', {\n      maxLines: Infinity,\n      minLines: 20,\n      value: fileContent,\n      showPrintMargin: false,\n      readOnly: this.req.type === 'textImmutable',\n      theme: 'ace/theme/chrome',\n      mode: modelist.getModeForPath(this.req.name).mode,\n      wrap: true\n    })\n\n    if (theme == 'dark') {\n      this.editor.setTheme(\"ace/theme/twilight\");\n    }\n  },\n  methods: {\n    keyEvent (event) {\n      if (!event.ctrlKey && !event.metaKey) {\n        return\n      }\n\n      if (String.fromCharCode(event.which).toLowerCase() !== 's') {\n        return\n      }\n\n      event.preventDefault()\n      this.save()\n    },\n    async save () {\n      const button = 'save'\n      buttons.loading('save')\n\n      try {\n        await api.put(this.$route.path, this.editor.getValue())\n        buttons.success(button)\n      } catch (e) {\n        buttons.done(button)\n        this.$showError(e)\n      }\n    }\n  }\n}\n</script>\n"]}]}