{"remainingRequest":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lq/ifb/src/eshop/frontend/src/components/files/ExtendedImage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/lq/ifb/src/eshop/frontend/src/components/files/ExtendedImage.vue","mtime":1583132470972},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgc3JjOiBTdHJpbmcsCiAgICBtb3ZlRGlzYWJsZWRUaW1lOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogKCkgPT4gMjAwCiAgICB9LAogICAgbWF4U2NhbGU6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAoKSA9PiA0CiAgICB9LAogICAgbWluU2NhbGU6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAoKSA9PiAwLjI1CiAgICB9LAogICAgY2xhc3NMaXN0OiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiBbXQogICAgfSwKICAgIHpvb21TdGVwOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogKCkgPT4gMC4yNQogICAgfSwKICAgIGF1dG9maWxsOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6ICgpID0+IGZhbHNlCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2NhbGU6IDEsCiAgICAgIGxhc3RYOiBudWxsLAogICAgICBsYXN0WTogbnVsbCwKICAgICAgaW5EcmFnOiBmYWxzZSwKICAgICAgbGFzdFRvdWNoRGlzdGFuY2U6IDAsCiAgICAgIG1vdmVEaXNhYmxlZDogZmFsc2UsCiAgICAgIGRpc2FibGVkVGltZXI6IG51bGwKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBsZXQgY29udGFpbmVyID0gdGhpcy4kcmVmcy5jb250YWluZXIKICAgIHRoaXMuY2xhc3NMaXN0LmZvckVhY2goY2xhc3NOYW1lID0+IGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSkpCiAgICAvLyBzZXQgd2lkdGggYW5kIGhlaWdodCBpZiB0aGV5IGFyZSB6ZXJvCiAgICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShjb250YWluZXIpLndpZHRoID09PSAiMHB4IikgewogICAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSAiMTAwJSIKICAgIH0KICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKGNvbnRhaW5lcikuaGVpZ2h0ID09PSAiMHB4IikgewogICAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXRDZW50ZXIoKSB7CiAgICAgIGxldCBjb250YWluZXIgPSB0aGlzLiRyZWZzLmNvbnRhaW5lcgogICAgICBsZXQgaW1nID0gdGhpcy4kcmVmcy5pbWdleAoKICAgICAgbGV0IHJhdGUgPSBNYXRoLm1pbigKICAgICAgICBjb250YWluZXIuY2xpZW50V2lkdGggLyBpbWcuY2xpZW50V2lkdGgsCiAgICAgICAgY29udGFpbmVyLmNsaWVudEhlaWdodCAvIGltZy5jbGllbnRIZWlnaHQKICAgICAgKQogICAgICBpZiAoIXRoaXMuYXV0b2ZpbGwgJiYgcmF0ZSA+IDEpIHsKICAgICAgICByYXRlID0gMQogICAgICB9CiAgICAgIC8vIGhlaWdodCB3aWxsIGJlIGF1dG8gc2V0CiAgICAgIGltZy53aWR0aCA9IE1hdGguZmxvb3IoaW1nLmNsaWVudFdpZHRoICogcmF0ZSkKICAgICAgaW1nLnN0eWxlLnRvcCA9IGAke01hdGguZmxvb3IoKGNvbnRhaW5lci5jbGllbnRIZWlnaHQgLSBpbWcuY2xpZW50SGVpZ2h0KSAvIDIpfXB4YAogICAgICBpbWcuc3R5bGUubGVmdCA9IGAke01hdGguZmxvb3IoKGNvbnRhaW5lci5jbGllbnRXaWR0aCAtIGltZy5jbGllbnRXaWR0aCkgLyAyKX1weGAKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsICgpID0+IHRoaXMuaW5EcmFnID0gZmFsc2UgKQogICAgfSwKICAgIG1vdXNlZG93blN0YXJ0KGV2ZW50KSB7CiAgICAgIHRoaXMubGFzdFggPSBudWxsCiAgICAgIHRoaXMubGFzdFkgPSBudWxsCiAgICAgIHRoaXMuaW5EcmFnID0gdHJ1ZQogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpCiAgICB9LAogICAgbW91c2VNb3ZlKGV2ZW50KSB7CiAgICAgIGlmICghdGhpcy5pbkRyYWcpIHJldHVybgogICAgICB0aGlzLmRvTW92ZShldmVudC5tb3ZlbWVudFgsIGV2ZW50Lm1vdmVtZW50WSkKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKQogICAgfSwKICAgIG1vdXNlVXAoZXZlbnQpIHsKICAgICAgdGhpcy5pbkRyYWcgPSBmYWxzZQogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpCiAgICB9LAogICAgdG91Y2hTdGFydChldmVudCkgewogICAgICB0aGlzLmxhc3RYID0gbnVsbAogICAgICB0aGlzLmxhc3RZID0gbnVsbAogICAgICB0aGlzLmxhc3RUb3VjaERpc3RhbmNlID0gbnVsbAogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpCiAgICB9LAogICAgem9vbUF1dG8oZXZlbnQpIHsKICAgICAgc3dpdGNoICh0aGlzLnNjYWxlKSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdGhpcy5zY2FsZSA9IDIKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdGhpcy5zY2FsZSA9IDQKICAgICAgICAgIGJyZWFrCiAgICAgICAgZGVmYXVsdDoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICB0aGlzLnNjYWxlID0gMQogICAgICAgICAgYnJlYWsKICAgICAgfQogICAgICB0aGlzLnNldFpvb20oKQogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpCiAgICB9LAogICAgdG91Y2hNb3ZlKGV2ZW50KSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCkKICAgICAgaWYgKHRoaXMubGFzdFggPT09IG51bGwpIHsKICAgICAgICB0aGlzLmxhc3RYID0gZXZlbnQudGFyZ2V0VG91Y2hlc1swXS5wYWdlWAogICAgICAgIHRoaXMubGFzdFkgPSBldmVudC50YXJnZXRUb3VjaGVzWzBdLnBhZ2VZCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgbGV0IHN0ZXAgPSB0aGlzLiRyZWZzLmltZ2V4LndpZHRoIC8gNQogICAgICBpZiAoZXZlbnQudGFyZ2V0VG91Y2hlcy5sZW5ndGggPT09IDIpIHsKICAgICAgICB0aGlzLm1vdmVEaXNhYmxlZCA9IHRydWUKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5kaXNhYmxlZFRpbWVyKQogICAgICAgIHRoaXMuZGlzYWJsZWRUaW1lciA9IHNldFRpbWVvdXQoCiAgICAgICAgICAoKSA9PiAodGhpcy5tb3ZlRGlzYWJsZWQgPSBmYWxzZSksCiAgICAgICAgICB0aGlzLm1vdmVEaXNhYmxlZFRpbWUKICAgICAgICApCgogICAgICAgIGxldCBwMSA9IGV2ZW50LnRhcmdldFRvdWNoZXNbMF0KICAgICAgICBsZXQgcDIgPSBldmVudC50YXJnZXRUb3VjaGVzWzFdCiAgICAgICAgbGV0IHRvdWNoRGlzdGFuY2UgPSBNYXRoLnNxcnQoCiAgICAgICAgICBNYXRoLnBvdyhwMi5wYWdlWCAtIHAxLnBhZ2VYLCAyKSArIE1hdGgucG93KHAyLnBhZ2VZIC0gcDEucGFnZVksIDIpCiAgICAgICAgKQogICAgICAgIGlmICghdGhpcy5sYXN0VG91Y2hEaXN0YW5jZSkgewogICAgICAgICAgdGhpcy5sYXN0VG91Y2hEaXN0YW5jZSA9IHRvdWNoRGlzdGFuY2UKICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICB0aGlzLnNjYWxlICs9ICh0b3VjaERpc3RhbmNlIC0gdGhpcy5sYXN0VG91Y2hEaXN0YW5jZSkgLyBzdGVwCiAgICAgICAgdGhpcy5sYXN0VG91Y2hEaXN0YW5jZSA9IHRvdWNoRGlzdGFuY2UKICAgICAgICB0aGlzLnNldFpvb20oKQogICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldFRvdWNoZXMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgaWYgKHRoaXMubW92ZURpc2FibGVkKSByZXR1cm4KICAgICAgICBsZXQgeCA9IGV2ZW50LnRhcmdldFRvdWNoZXNbMF0ucGFnZVggLSB0aGlzLmxhc3RYCiAgICAgICAgbGV0IHkgPSBldmVudC50YXJnZXRUb3VjaGVzWzBdLnBhZ2VZIC0gdGhpcy5sYXN0WQogICAgICAgIGlmIChNYXRoLmFicyh4KSA+PSBzdGVwICYmIE1hdGguYWJzKHkpID49IHN0ZXApIHJldHVybgogICAgICAgIHRoaXMubGFzdFggPSBldmVudC50YXJnZXRUb3VjaGVzWzBdLnBhZ2VYCiAgICAgICAgdGhpcy5sYXN0WSA9IGV2ZW50LnRhcmdldFRvdWNoZXNbMF0ucGFnZVkKICAgICAgICB0aGlzLmRvTW92ZSh4LCB5KQogICAgICB9CiAgICB9LAogICAgZG9Nb3ZlKHgsIHkpIHsKICAgICAgbGV0IHN0eWxlID0gdGhpcy4kcmVmcy5pbWdleC5zdHlsZQogICAgICBzdHlsZS5sZWZ0ID0gYCR7dGhpcy5weFN0cmluZ1RvTnVtYmVyKHN0eWxlLmxlZnQpICsgeH1weGAKICAgICAgc3R5bGUudG9wID0gYCR7dGhpcy5weFN0cmluZ1RvTnVtYmVyKHN0eWxlLnRvcCkgKyB5fXB4YAogICAgfSwKICAgIHdoZWVsTW92ZShldmVudCkgewogICAgICB0aGlzLnNjYWxlICs9IChldmVudC53aGVlbERlbHRhWSAvIDEwMCkgKiB0aGlzLnpvb21TdGVwCiAgICAgIHRoaXMuc2V0Wm9vbSgpCiAgICB9LAogICAgc2V0Wm9vbSgpIHsKICAgICAgdGhpcy5zY2FsZSA9IHRoaXMuc2NhbGUgPCB0aGlzLm1pblNjYWxlID8gdGhpcy5taW5TY2FsZSA6IHRoaXMuc2NhbGUKICAgICAgdGhpcy5zY2FsZSA9IHRoaXMuc2NhbGUgPiB0aGlzLm1heFNjYWxlID8gdGhpcy5tYXhTY2FsZSA6IHRoaXMuc2NhbGUKICAgICAgdGhpcy4kcmVmcy5pbWdleC5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHt0aGlzLnNjYWxlfSlgCiAgICB9LAogICAgcHhTdHJpbmdUb051bWJlcihzdHlsZSkgewogICAgICByZXR1cm4gK3N0eWxlLnJlcGxhY2UoInB4IiwgIiIpCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["ExtendedImage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ExtendedImage.vue","sourceRoot":"src/components/files","sourcesContent":["<template>\n  <div\n    class=\"image-ex-container\"\n    ref=\"container\"\n    @touchstart=\"touchStart\"\n    @touchmove=\"touchMove\"\n    @dblclick=\"zoomAuto\"\n    @mousedown=\"mousedownStart\"\n    @mousemove=\"mouseMove\"\n    @mouseup=\"mouseUp\"\n    @wheel=\"wheelMove\"\n  >\n    <img :src=\"src\" class=\"image-ex-img\" ref=\"imgex\" @load=\"setCenter\">\n  </div>\n</template>\n<script>\nexport default {\n  props: {\n    src: String,\n    moveDisabledTime: {\n      type: Number,\n      default: () => 200\n    },\n    maxScale: {\n      type: Number,\n      default: () => 4\n    },\n    minScale: {\n      type: Number,\n      default: () => 0.25\n    },\n    classList: {\n      type: Array,\n      default: () => []\n    },\n    zoomStep: {\n      type: Number,\n      default: () => 0.25\n    },\n    autofill: {\n      type: Boolean,\n      default: () => false\n    }\n  },\n  data() {\n    return {\n      scale: 1,\n      lastX: null,\n      lastY: null,\n      inDrag: false,\n      lastTouchDistance: 0,\n      moveDisabled: false,\n      disabledTimer: null\n    }\n  },\n  mounted() {\n    let container = this.$refs.container\n    this.classList.forEach(className => container.classList.add(className))\n    // set width and height if they are zero\n    if (getComputedStyle(container).width === \"0px\") {\n      container.style.width = \"100%\"\n    }\n    if (getComputedStyle(container).height === \"0px\") {\n      container.style.height = \"100%\"\n    }\n  },\n  methods: {\n    setCenter() {\n      let container = this.$refs.container\n      let img = this.$refs.imgex\n\n      let rate = Math.min(\n        container.clientWidth / img.clientWidth,\n        container.clientHeight / img.clientHeight\n      )\n      if (!this.autofill && rate > 1) {\n        rate = 1\n      }\n      // height will be auto set\n      img.width = Math.floor(img.clientWidth * rate)\n      img.style.top = `${Math.floor((container.clientHeight - img.clientHeight) / 2)}px`\n      img.style.left = `${Math.floor((container.clientWidth - img.clientWidth) / 2)}px`\n      document.addEventListener('mouseup', () => this.inDrag = false )\n    },\n    mousedownStart(event) {\n      this.lastX = null\n      this.lastY = null\n      this.inDrag = true\n      event.preventDefault()\n    },\n    mouseMove(event) {\n      if (!this.inDrag) return\n      this.doMove(event.movementX, event.movementY)\n      event.preventDefault()\n    },\n    mouseUp(event) {\n      this.inDrag = false\n      event.preventDefault()\n    },\n    touchStart(event) {\n      this.lastX = null\n      this.lastY = null\n      this.lastTouchDistance = null\n      event.preventDefault()\n    },\n    zoomAuto(event) {\n      switch (this.scale) {\n        case 1:\n          this.scale = 2\n          break\n        case 2:\n          this.scale = 4\n          break\n        default:\n        case 4:\n          this.scale = 1\n          break\n      }\n      this.setZoom()\n      event.preventDefault()\n    },\n    touchMove(event) {\n      event.preventDefault()\n      if (this.lastX === null) {\n        this.lastX = event.targetTouches[0].pageX\n        this.lastY = event.targetTouches[0].pageY\n        return\n      }\n      let step = this.$refs.imgex.width / 5\n      if (event.targetTouches.length === 2) {\n        this.moveDisabled = true\n        clearTimeout(this.disabledTimer)\n        this.disabledTimer = setTimeout(\n          () => (this.moveDisabled = false),\n          this.moveDisabledTime\n        )\n\n        let p1 = event.targetTouches[0]\n        let p2 = event.targetTouches[1]\n        let touchDistance = Math.sqrt(\n          Math.pow(p2.pageX - p1.pageX, 2) + Math.pow(p2.pageY - p1.pageY, 2)\n        )\n        if (!this.lastTouchDistance) {\n          this.lastTouchDistance = touchDistance\n          return\n        }\n        this.scale += (touchDistance - this.lastTouchDistance) / step\n        this.lastTouchDistance = touchDistance\n        this.setZoom()\n      } else if (event.targetTouches.length === 1) {\n        if (this.moveDisabled) return\n        let x = event.targetTouches[0].pageX - this.lastX\n        let y = event.targetTouches[0].pageY - this.lastY\n        if (Math.abs(x) >= step && Math.abs(y) >= step) return\n        this.lastX = event.targetTouches[0].pageX\n        this.lastY = event.targetTouches[0].pageY\n        this.doMove(x, y)\n      }\n    },\n    doMove(x, y) {\n      let style = this.$refs.imgex.style\n      style.left = `${this.pxStringToNumber(style.left) + x}px`\n      style.top = `${this.pxStringToNumber(style.top) + y}px`\n    },\n    wheelMove(event) {\n      this.scale += (event.wheelDeltaY / 100) * this.zoomStep\n      this.setZoom()\n    },\n    setZoom() {\n      this.scale = this.scale < this.minScale ? this.minScale : this.scale\n      this.scale = this.scale > this.maxScale ? this.maxScale : this.scale\n      this.$refs.imgex.style.transform = `scale(${this.scale})`\n    },\n    pxStringToNumber(style) {\n      return +style.replace(\"px\", \"\")\n    }\n  }\n}\n</script>\n<style>\n.image-ex-container {\n  margin: auto;\n  overflow: hidden;\n  position: relative;\n}\n\n.image-ex-img {\n  left: 0;\n  top: 0;\n  position: absolute;\n  transition: transform 0.1s ease;\n}\n</style>\n"]}]}