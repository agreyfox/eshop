{"remainingRequest":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lq/ifb/src/eshop/frontend/src/components/prompts/FileList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/lq/ifb/src/eshop/frontend/src/components/prompts/FileList.vue","mtime":1583132470976},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IHVybCBmcm9tICdAL3V0aWxzL3VybCcKaW1wb3J0IHsgZmlsZXMgfSBmcm9tICdAL2FwaScKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZmlsZS1saXN0JywKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBpdGVtczogW10sCiAgICAgIHRvdWNoZXM6IHsKICAgICAgICBpZDogJycsCiAgICAgICAgY291bnQ6IDAKICAgICAgfSwKICAgICAgc2VsZWN0ZWQ6IG51bGwsCiAgICAgIGN1cnJlbnQ6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKFsgJ3JlcScgXSksCiAgICBuYXYgKCkgewogICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHRoaXMuY3VycmVudCkKICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgLy8gSWYgd2UncmUgc2hvd2luZyB0aGlzIG9uIGEgbGlzdGluZywKICAgIC8vIHdlIGNhbiB1c2UgdGhlIGN1cnJlbnQgcmVxdWVzdCBvYmplY3QKICAgIC8vIHRvIGZpbGwgdGhlIG1vdmUgb3B0aW9ucy4KICAgIGlmICh0aGlzLnJlcS5raW5kID09PSAnbGlzdGluZycpIHsKICAgICAgdGhpcy5maWxsT3B0aW9ucyh0aGlzLnJlcSkKICAgICAgcmV0dXJuCiAgICB9CgogICAgLy8gT3RoZXJ3aXNlLCB3ZSBtdXN0IGJlIG9uIGEgcHJldmlldyBvciBlZGl0b3IKICAgIC8vIHNvIHdlIGZldGNoIHRoZSBkYXRhIGZyb20gdGhlIHByZXZpb3VzIGRpcmVjdG9yeS4KICAgIGZpbGVzLmZldGNoKHVybC5yZW1vdmVMYXN0RGlyKHRoaXMuJHJvdXRlLnBhdGgpKQogICAgICAudGhlbih0aGlzLmZpbGxPcHRpb25zKQogICAgICAuY2F0Y2godGhpcy4kc2hvd0Vycm9yKQogIH0sCiAgbWV0aG9kczogewogICAgZmlsbE9wdGlvbnMgKHJlcSkgewogICAgICAvLyBTZXRzIHRoZSBjdXJyZW50IHBhdGggYW5kIHJlc2V0cwogICAgICAvLyB0aGUgY3VycmVudCBpdGVtcy4KICAgICAgdGhpcy5jdXJyZW50ID0gcmVxLnVybAogICAgICB0aGlzLml0ZW1zID0gW10KCiAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpzZWxlY3RlZCcsIHRoaXMuY3VycmVudCkKCiAgICAgIC8vIElmIHRoZSBwYXRoIGlzbid0IHRoZSByb290IHBhdGgsCiAgICAgIC8vIHNob3cgYSBidXR0b24gdG8gbmF2aWdhdGUgdG8gdGhlIHByZXZpb3VzCiAgICAgIC8vIGRpcmVjdG9yeS4KICAgICAgaWYgKHJlcS51cmwgIT09ICcvZmlsZXMvJykgewogICAgICAgIHRoaXMuaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiAnLi4nLAogICAgICAgICAgdXJsOiB1cmwucmVtb3ZlTGFzdERpcihyZXEudXJsKSArICcvJwogICAgICAgIH0pCiAgICAgIH0KCiAgICAgIC8vIElmIHRoaXMgZm9sZGVyIGlzIGVtcHR5LCBmaW5pc2ggaGVyZS4KICAgICAgaWYgKHJlcS5pdGVtcyA9PT0gbnVsbCkgcmV0dXJuCgogICAgICAvLyBPdGhlcndpc2Ugd2UgYWRkIGV2ZXJ5IGRpcmVjdG9yeSB0byB0aGUKICAgICAgLy8gbW92ZSBvcHRpb25zLgogICAgICBmb3IgKGxldCBpdGVtIG9mIHJlcS5pdGVtcykgewogICAgICAgIGlmICghaXRlbS5pc0RpcikgY29udGludWUKCiAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHsKICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSwKICAgICAgICAgIHVybDogaXRlbS51cmwKICAgICAgICB9KQogICAgICB9CiAgICB9LAogICAgbmV4dDogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIC8vIFJldHJpZXZlcyB0aGUgVVJMIG9mIHRoZSBkaXJlY3RvcnkgdGhlIHVzZXIKICAgICAgLy8ganVzdCBjbGlja2VkIGluIGFuZCBmaWxsIHRoZSBvcHRpb25zIHdpdGggaXRzCiAgICAgIC8vIGNvbnRlbnQuCiAgICAgIGxldCB1cmkgPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudXJsCgogICAgICBmaWxlcy5mZXRjaCh1cmkpCiAgICAgICAgLnRoZW4odGhpcy5maWxsT3B0aW9ucykKICAgICAgICAuY2F0Y2godGhpcy4kc2hvd0Vycm9yKQogICAgfSwKICAgIHRvdWNoc3RhcnQgKGV2ZW50KSB7CiAgICAgIGxldCB1cmwgPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudXJsCgogICAgICAvLyBJbiAzMDAgbWlsbGlzZWNvbmRzLCB3ZSBzaGFsbCByZXNldCB0aGUgY291bnQuCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMudG91Y2hlcy5jb3VudCA9IDAKICAgICAgfSwgMzAwKQoKICAgICAgLy8gSWYgdGhlIGVsZW1lbnQgdGhlIHVzZXIgaXMgdG91Y2hpbmcKICAgICAgLy8gaXMgZGlmZmVyZW50IGZyb20gdGhlIGxhc3Qgb25lIGhlIHRvdWNoZWQsCiAgICAgIC8vIHJlc2V0IHRoZSBjb3VudC4KICAgICAgaWYgKHRoaXMudG91Y2hlcy5pZCAhPT0gdXJsKSB7CiAgICAgICAgdGhpcy50b3VjaGVzLmlkID0gdXJsCiAgICAgICAgdGhpcy50b3VjaGVzLmNvdW50ID0gMQogICAgICAgIHJldHVybgogICAgICB9CgogICAgICB0aGlzLnRvdWNoZXMuY291bnQrKwoKICAgICAgLy8gSWYgdGhlcmUgaXMgbW9yZSB0aGFuIG9uZSB0b3VjaCBhbHJlYWR5LAogICAgICAvLyBvcGVuIHRoZSBuZXh0IHNjcmVlbi4KICAgICAgaWYgKHRoaXMudG91Y2hlcy5jb3VudCA+IDEpIHsKICAgICAgICB0aGlzLm5leHQoZXZlbnQpCiAgICAgIH0KICAgIH0sCiAgICBzZWxlY3Q6IGZ1bmN0aW9uIChldmVudCkgewogICAgICAvLyBJZiB0aGUgZWxlbWVudCBpcyBhbHJlYWR5IHNlbGVjdGVkLCB1bnNlbGVjdCBpdC4KICAgICAgaWYgKHRoaXMuc2VsZWN0ZWQgPT09IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC51cmwpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkID0gbnVsbAogICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpzZWxlY3RlZCcsIHRoaXMuY3VycmVudCkKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgLy8gT3RoZXJ3aXNlIHNlbGVjdCB0aGUgZWxlbWVudC4KICAgICAgdGhpcy5zZWxlY3RlZCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC51cmwKICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGVkJywgdGhpcy5zZWxlY3RlZCkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["FileList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"FileList.vue","sourceRoot":"src/components/prompts","sourcesContent":["<template>\n  <div>\n    <ul class=\"file-list\">\n      <li @click=\"select\"\n        @touchstart=\"touchstart\"\n        @dblclick=\"next\"\n        role=\"button\"\n        tabindex=\"0\"\n        :aria-label=\"item.name\"\n        :aria-selected=\"selected == item.url\"\n        :key=\"item.name\" v-for=\"item in items\"\n        :data-url=\"item.url\">{{ item.name }}</li>\n    </ul>\n\n    <p>{{ $t('prompts.currentlyNavigating') }} <code>{{ nav }}</code>.</p>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport url from '@/utils/url'\nimport { files } from '@/api'\n\nexport default {\n  name: 'file-list',\n  data: function () {\n    return {\n      items: [],\n      touches: {\n        id: '',\n        count: 0\n      },\n      selected: null,\n      current: window.location.pathname\n    }\n  },\n  computed: {\n    ...mapState([ 'req' ]),\n    nav () {\n      return decodeURIComponent(this.current)\n    }\n  },\n  mounted () {\n    // If we're showing this on a listing,\n    // we can use the current request object\n    // to fill the move options.\n    if (this.req.kind === 'listing') {\n      this.fillOptions(this.req)\n      return\n    }\n\n    // Otherwise, we must be on a preview or editor\n    // so we fetch the data from the previous directory.\n    files.fetch(url.removeLastDir(this.$route.path))\n      .then(this.fillOptions)\n      .catch(this.$showError)\n  },\n  methods: {\n    fillOptions (req) {\n      // Sets the current path and resets\n      // the current items.\n      this.current = req.url\n      this.items = []\n\n      this.$emit('update:selected', this.current)\n\n      // If the path isn't the root path,\n      // show a button to navigate to the previous\n      // directory.\n      if (req.url !== '/files/') {\n        this.items.push({\n          name: '..',\n          url: url.removeLastDir(req.url) + '/'\n        })\n      }\n\n      // If this folder is empty, finish here.\n      if (req.items === null) return\n\n      // Otherwise we add every directory to the\n      // move options.\n      for (let item of req.items) {\n        if (!item.isDir) continue\n\n        this.items.push({\n          name: item.name,\n          url: item.url\n        })\n      }\n    },\n    next: function (event) {\n      // Retrieves the URL of the directory the user\n      // just clicked in and fill the options with its\n      // content.\n      let uri = event.currentTarget.dataset.url\n\n      files.fetch(uri)\n        .then(this.fillOptions)\n        .catch(this.$showError)\n    },\n    touchstart (event) {\n      let url = event.currentTarget.dataset.url\n\n      // In 300 milliseconds, we shall reset the count.\n      setTimeout(() => {\n        this.touches.count = 0\n      }, 300)\n\n      // If the element the user is touching\n      // is different from the last one he touched,\n      // reset the count.\n      if (this.touches.id !== url) {\n        this.touches.id = url\n        this.touches.count = 1\n        return\n      }\n\n      this.touches.count++\n\n      // If there is more than one touch already,\n      // open the next screen.\n      if (this.touches.count > 1) {\n        this.next(event)\n      }\n    },\n    select: function (event) {\n      // If the element is already selected, unselect it.\n      if (this.selected === event.currentTarget.dataset.url) {\n        this.selected = null\n        this.$emit('update:selected', this.current)\n        return\n      }\n\n      // Otherwise select the element.\n      this.selected = event.currentTarget.dataset.url\n      this.$emit('update:selected', this.selected)\n    }\n  }\n}\n</script>\n"]}]}