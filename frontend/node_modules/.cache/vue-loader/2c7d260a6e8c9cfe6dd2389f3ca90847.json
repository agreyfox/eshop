{"remainingRequest":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lq/ifb/src/eshop/frontend/src/components/Shell.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/lq/ifb/src/eshop/frontend/src/components/Shell.vue","mtime":1583132470972},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcE11dGF0aW9ucywgbWFwU3RhdGUsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwppbXBvcnQgeyBjb21tYW5kcyB9IGZyb20gJ0AvYXBpJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdzaGVsbCcsCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKFsgJ3VzZXInLCAnc2hvd1NoZWxsJyBdKSwKICAgIC4uLm1hcEdldHRlcnMoWyAnaXNGaWxlcycsICdpc0xvZ2dlZCcgXSksCiAgICBwYXRoOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLmlzRmlsZXMpIHsKICAgICAgICByZXR1cm4gdGhpcy4kcm91dGUucGF0aAogICAgICB9CgogICAgICByZXR1cm4gJycKICAgIH0KICB9LAogIGRhdGE6ICgpID0+ICh7CiAgICBjb250ZW50OiBbXSwKICAgIGhpc3Rvcnk6IFtdLAogICAgaGlzdG9yeVBvczogMCwKICAgIGNhbklucHV0OiB0cnVlCiAgfSksCiAgbWV0aG9kczogewogICAgLi4ubWFwTXV0YXRpb25zKFsgJ3RvZ2dsZVNoZWxsJyBdKSwKICAgIHNjcm9sbDogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLiRyZWZzLnNjcm9sbGFibGUuc2Nyb2xsVG9wID0gdGhpcy4kcmVmcy5zY3JvbGxhYmxlLnNjcm9sbEhlaWdodAogICAgfSwKICAgIGZvY3VzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuJHJlZnMuaW5wdXQuZm9jdXMoKQogICAgfSwKICAgIGhpc3RvcnlVcCAoKSB7CiAgICAgIGlmICh0aGlzLmhpc3RvcnlQb3MgPiAwKSB7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC5pbm5lclRleHQgPSB0aGlzLmhpc3RvcnlbLS10aGlzLmhpc3RvcnlQb3NdCiAgICAgICAgdGhpcy5mb2N1cygpCiAgICAgIH0KICAgIH0sCiAgICBoaXN0b3J5RG93biAoKSB7CiAgICAgIGlmICh0aGlzLmhpc3RvcnlQb3MgPj0gMCAmJiB0aGlzLmhpc3RvcnlQb3MgPCB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMSkgewogICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuaW5uZXJUZXh0ID0gdGhpcy5oaXN0b3J5WysrdGhpcy5oaXN0b3J5UG9zXQogICAgICAgIHRoaXMuZm9jdXMoKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaGlzdG9yeVBvcyA9IHRoaXMuaGlzdG9yeS5sZW5ndGgKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LmlubmVyVGV4dCA9ICcnCiAgICAgIH0KICAgIH0sCiAgICBzdWJtaXQ6IGZ1bmN0aW9uIChldmVudCkgewogICAgICBjb25zdCBjbWQgPSBldmVudC50YXJnZXQuaW5uZXJUZXh0LnRyaW0oKQoKICAgICAgaWYgKGNtZCA9PT0gJycpIHsKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgaWYgKGNtZCA9PT0gJ2NsZWFyJykgewogICAgICAgIHRoaXMuY29udGVudCA9IFtdCiAgICAgICAgZXZlbnQudGFyZ2V0LmlubmVySFRNTCA9ICcnCiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIGlmIChjbWQgPT09ICdleGl0JykgewogICAgICAgIGV2ZW50LnRhcmdldC5pbm5lckhUTUwgPSAnJwogICAgICAgIHRoaXMudG9nZ2xlU2hlbGwoKQogICAgICAgIHJldHVybgogICAgICB9CgogICAgICB0aGlzLmNhbklucHV0ID0gZmFsc2UKICAgICAgZXZlbnQudGFyZ2V0LmlubmVySFRNTCA9ICcnCgogICAgICBsZXQgcmVzdWx0cyA9IHsKICAgICAgICB0ZXh0OiBgJHtjbWR9XG5cbmAKICAgICAgfQogICAgICAKICAgICAgdGhpcy5oaXN0b3J5LnB1c2goY21kKQogICAgICB0aGlzLmhpc3RvcnlQb3MgPSB0aGlzLmhpc3RvcnkubGVuZ3RoCiAgICAgIHRoaXMuY29udGVudC5wdXNoKHJlc3VsdHMpCgogICAgICBjb21tYW5kcygKICAgICAgICB0aGlzLnBhdGgsCiAgICAgICAgY21kLAogICAgICAgIGV2ZW50ID0+IHsKICAgICAgICAgIHJlc3VsdHMudGV4dCArPSBgJHtldmVudC5kYXRhfVxuYAogICAgICAgICAgdGhpcy5zY3JvbGwoKQogICAgICAgIH0sCiAgICAgICAgKCkgPT4gewogICAgICAgICAgcmVzdWx0cy50ZXh0ID0gcmVzdWx0cy50ZXh0LnRyaW1FbmQoKQogICAgICAgICAgdGhpcy5jYW5JbnB1dCA9IHRydWUKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuZm9jdXMoKQogICAgICAgICAgdGhpcy5zY3JvbGwoKQogICAgICAgIH0KICAgICAgKQogICAgfQogIH0KfQo="},{"version":3,"sources":["Shell.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Shell.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div @click=\"focus\" class=\"shell\" ref=\"scrollable\" :class=\"{ ['shell--hidden']: !showShell}\">\n    <div v-for=\"(c, index) in content\" :key=\"index\" class=\"shell__result\" >\n      <div class=\"shell__prompt\"><i class=\"material-icons\">chevron_right</i></div>\n      <pre class=\"shell__text\">{{ c.text }}</pre>\n    </div>\n\n    <div class=\"shell__result\" :class=\"{ 'shell__result--hidden': !canInput }\" >\n      <div class=\"shell__prompt\"><i class=\"material-icons\">chevron_right</i></div>\n      <pre\n        tabindex=\"0\"\n        ref=\"input\"\n        class=\"shell__text\"\n        contenteditable=\"true\"\n        @keydown.prevent.38=\"historyUp\"\n        @keydown.prevent.40=\"historyDown\"\n        @keypress.prevent.enter=\"submit\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapMutations, mapState, mapGetters } from 'vuex'\nimport { commands } from '@/api'\n\nexport default {\n  name: 'shell',\n  computed: {\n    ...mapState([ 'user', 'showShell' ]),\n    ...mapGetters([ 'isFiles', 'isLogged' ]),\n    path: function () {\n      if (this.isFiles) {\n        return this.$route.path\n      }\n\n      return ''\n    }\n  },\n  data: () => ({\n    content: [],\n    history: [],\n    historyPos: 0,\n    canInput: true\n  }),\n  methods: {\n    ...mapMutations([ 'toggleShell' ]),\n    scroll: function () {\n      this.$refs.scrollable.scrollTop = this.$refs.scrollable.scrollHeight\n    },\n    focus: function () {\n      this.$refs.input.focus()\n    },\n    historyUp () {\n      if (this.historyPos > 0) {\n        this.$refs.input.innerText = this.history[--this.historyPos]\n        this.focus()\n      }\n    },\n    historyDown () {\n      if (this.historyPos >= 0 && this.historyPos < this.history.length - 1) {\n        this.$refs.input.innerText = this.history[++this.historyPos]\n        this.focus()\n      } else {\n        this.historyPos = this.history.length\n        this.$refs.input.innerText = ''\n      }\n    },\n    submit: function (event) {\n      const cmd = event.target.innerText.trim()\n\n      if (cmd === '') {\n        return\n      }\n\n      if (cmd === 'clear') {\n        this.content = []\n        event.target.innerHTML = ''\n        return\n      }\n\n      if (cmd === 'exit') {\n        event.target.innerHTML = ''\n        this.toggleShell()\n        return\n      }\n\n      this.canInput = false\n      event.target.innerHTML = ''\n\n      let results = {\n        text: `${cmd}\\n\\n`\n      }\n      \n      this.history.push(cmd)\n      this.historyPos = this.history.length\n      this.content.push(results)\n\n      commands(\n        this.path,\n        cmd,\n        event => {\n          results.text += `${event.data}\\n`\n          this.scroll()\n        },\n        () => {\n          results.text = results.text.trimEnd()\n          this.canInput = true\n          this.$refs.input.focus()\n          this.scroll()\n        }\n      )\n    }\n  }\n}\n</script>\n"]}]}