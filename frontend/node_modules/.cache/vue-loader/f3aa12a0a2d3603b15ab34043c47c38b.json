{"remainingRequest":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lq/ifb/src/eshop/frontend/src/components/prompts/Rename.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/lq/ifb/src/eshop/frontend/src/components/prompts/Rename.vue","mtime":1583132470976},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCcKaW1wb3J0IHVybCBmcm9tICdAL3V0aWxzL3VybCcKaW1wb3J0IHsgZmlsZXMgYXMgYXBpIH0gZnJvbSAnQC9hcGknCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ3JlbmFtZScsCiAgZGF0YTogZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogJycKICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgdGhpcy5uYW1lID0gdGhpcy5vbGROYW1lKCkKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZShbJ3JlcScsICdzZWxlY3RlZCcsICdzZWxlY3RlZENvdW50J10pLAogICAgLi4ubWFwR2V0dGVycyhbJ2lzTGlzdGluZyddKQogIH0sCiAgbWV0aG9kczogewogICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnY2xvc2VIb3ZlcnMnKQogICAgfSwKICAgIG9sZE5hbWU6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzLmlzTGlzdGluZykgewogICAgICAgIHJldHVybiB0aGlzLnJlcS5uYW1lCiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkQ291bnQgPT09IDAgfHwgdGhpcy5zZWxlY3RlZENvdW50ID4gMSkgewogICAgICAgIC8vIFRoaXMgc2hvdWxkbid0IGhhcHBlbi4KICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMucmVxLml0ZW1zW3RoaXMuc2VsZWN0ZWRbMF1dLm5hbWUKICAgIH0sCiAgICBzdWJtaXQ6IGFzeW5jIGZ1bmN0aW9uICgpIHsKICAgICAgbGV0IG9sZExpbmsgPSAnJwogICAgICBsZXQgbmV3TGluayA9ICcnCgogICAgICBpZiAoIXRoaXMuaXNMaXN0aW5nKSB7CiAgICAgICAgb2xkTGluayA9IHRoaXMucmVxLnVybAogICAgICB9IGVsc2UgewogICAgICAgIG9sZExpbmsgPSB0aGlzLnJlcS5pdGVtc1t0aGlzLnNlbGVjdGVkWzBdXS51cmwKICAgICAgfQoKICAgICAgbmV3TGluayA9IHVybC5yZW1vdmVMYXN0RGlyKG9sZExpbmspICsgJy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMubmFtZSkKCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgYXBpLm1vdmUoW3sgZnJvbTogb2xkTGluaywgdG86IG5ld0xpbmsgfV0pCiAgICAgICAgaWYgKCF0aGlzLmlzTGlzdGluZykgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiBuZXdMaW5rIH0pCiAgICAgICAgICByZXR1cm4KICAgICAgICB9CgogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0UmVsb2FkJywgdHJ1ZSkKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRoaXMuJHNob3dFcnJvcihlKQogICAgICB9CgogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2Nsb3NlSG92ZXJzJykKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Rename.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Rename.vue","sourceRoot":"src/components/prompts","sourcesContent":["<template>\n  <div class=\"card floating\">\n    <div class=\"card-title\">\n      <h2>{{ $t('prompts.rename') }}</h2>\n    </div>\n\n    <div class=\"card-content\">\n      <p>{{ $t('prompts.renameMessage') }} <code>{{ oldName() }}</code>:</p>\n      <input class=\"input input--block\" v-focus type=\"text\" @keyup.enter=\"submit\" v-model.trim=\"name\">\n    </div>\n\n    <div class=\"card-action\">\n      <button class=\"button button--flat button--grey\"\n        @click=\"$store.commit('closeHovers')\"\n        :aria-label=\"$t('buttons.cancel')\"\n        :title=\"$t('buttons.cancel')\">{{ $t('buttons.cancel') }}</button>\n      <button @click=\"submit\"\n        class=\"button button--flat\"\n        type=\"submit\"\n        :aria-label=\"$t('buttons.rename')\"\n        :title=\"$t('buttons.rename')\">{{ $t('buttons.rename') }}</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapGetters } from 'vuex'\nimport url from '@/utils/url'\nimport { files as api } from '@/api'\n\nexport default {\n  name: 'rename',\n  data: function () {\n    return {\n      name: ''\n    }\n  },\n  created () {\n    this.name = this.oldName()\n  },\n  computed: {\n    ...mapState(['req', 'selected', 'selectedCount']),\n    ...mapGetters(['isListing'])\n  },\n  methods: {\n    cancel: function () {\n      this.$store.commit('closeHovers')\n    },\n    oldName: function () {\n      if (!this.isListing) {\n        return this.req.name\n      }\n\n      if (this.selectedCount === 0 || this.selectedCount > 1) {\n        // This shouldn't happen.\n        return\n      }\n\n      return this.req.items[this.selected[0]].name\n    },\n    submit: async function () {\n      let oldLink = ''\n      let newLink = ''\n\n      if (!this.isListing) {\n        oldLink = this.req.url\n      } else {\n        oldLink = this.req.items[this.selected[0]].url\n      }\n\n      newLink = url.removeLastDir(oldLink) + '/' + encodeURIComponent(this.name)\n\n      try {\n        await api.move([{ from: oldLink, to: newLink }])\n        if (!this.isListing) {\n          this.$router.push({ path: newLink })\n          return\n        }\n\n        this.$store.commit('setReload', true)\n      } catch (e) {\n        this.$showError(e)\n      }\n\n      this.$store.commit('closeHovers')\n    }\n  }\n}\n</script>\n"]}]}