{"remainingRequest":"/home/lq/ifb/src/eshop/frontend/node_modules/thread-loader/dist/cjs.js!/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js!/home/lq/ifb/src/eshop/frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/lq/ifb/src/eshop/frontend/src/api/files.js","dependencies":[{"path":"/home/lq/ifb/src/eshop/frontend/src/api/files.js","mtime":1583132470972},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/lq/ifb/src/eshop/frontend/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZW5kcy13aXRoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2xxL2lmYi9zcmMvZXNob3AvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgeyBmZXRjaFVSTCwgcmVtb3ZlUHJlZml4IH0gZnJvbSAnLi91dGlscyc7CmltcG9ydCB7IGJhc2VVUkwgfSBmcm9tICdAL3V0aWxzL2NvbnN0YW50cyc7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKZXhwb3J0IGZ1bmN0aW9uIGZldGNoKF94KSB7CiAgcmV0dXJuIF9mZXRjaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfZmV0Y2goKSB7CiAgX2ZldGNoID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodXJsKSB7CiAgICB2YXIgcmVzLCBkYXRhOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICB1cmwgPSByZW1vdmVQcmVmaXgodXJsKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBmZXRjaFVSTCgiL2FwaS9yZXNvdXJjZXMiLmNvbmNhdCh1cmwpLCB7fSk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyA9PT0gMjAwKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgZGF0YSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIGRhdGEudXJsID0gIi9maWxlcyIuY29uY2F0KHVybCk7CgogICAgICAgICAgICBpZiAoZGF0YS5pc0RpcikgewogICAgICAgICAgICAgIGlmICghZGF0YS51cmwuZW5kc1dpdGgoJy8nKSkgZGF0YS51cmwgKz0gJy8nOwogICAgICAgICAgICAgIGRhdGEuaXRlbXMgPSBkYXRhLml0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSBpbmRleDsKICAgICAgICAgICAgICAgIGl0ZW0udXJsID0gIiIuY29uY2F0KGRhdGEudXJsKS5jb25jYXQoZW5jb2RlVVJJQ29tcG9uZW50KGl0ZW0ubmFtZSkpOwoKICAgICAgICAgICAgICAgIGlmIChpdGVtLmlzRGlyKSB7CiAgICAgICAgICAgICAgICAgIGl0ZW0udXJsICs9ICcvJzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgZGF0YSk7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5zdGF0dXMpOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwogIHJldHVybiBfZmV0Y2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gcmVzb3VyY2VBY3Rpb24oX3gyLCBfeDMsIF94NCkgewogIHJldHVybiBfcmVzb3VyY2VBY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3Jlc291cmNlQWN0aW9uKCkgewogIF9yZXNvdXJjZUFjdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMih1cmwsIG1ldGhvZCwgY29udGVudCkgewogICAgdmFyIG9wdHMsIHJlczsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHVybCA9IHJlbW92ZVByZWZpeCh1cmwpOwogICAgICAgICAgICBvcHRzID0gewogICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBpZiAoY29udGVudCkgewogICAgICAgICAgICAgIG9wdHMuYm9keSA9IGNvbnRlbnQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuIGZldGNoVVJMKCIvYXBpL3Jlc291cmNlcyIuY29uY2F0KHVybCksIG9wdHMpOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9PSAyMDApKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5yZXNwb25zZVRleHQpOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZXMpOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSk7CiAgcmV0dXJuIF9yZXNvdXJjZUFjdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpleHBvcnQgZnVuY3Rpb24gcmVtb3ZlKF94NSkgewogIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9yZW1vdmUoKSB7CiAgX3JlbW92ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyh1cmwpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCByZXNvdXJjZUFjdGlvbih1cmwsICdERUxFVEUnKSk7CgogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMyk7CiAgfSkpOwogIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBwdXQoX3g2KSB7CiAgcmV0dXJuIF9wdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3B1dCgpIHsKICBfcHV0ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KHVybCkgewogICAgdmFyIGNvbnRlbnQsCiAgICAgICAgX2FyZ3M0ID0gYXJndW1lbnRzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29udGVudCA9IF9hcmdzNC5sZW5ndGggPiAxICYmIF9hcmdzNFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M0WzFdIDogJyc7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCByZXNvdXJjZUFjdGlvbih1cmwsICdQVVQnLCBjb250ZW50KSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNCk7CiAgfSkpOwogIHJldHVybiBfcHV0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBkb3dubG9hZChmb3JtYXQpIHsKICB2YXIgdXJsID0gIiIuY29uY2F0KGJhc2VVUkwsICIvYXBpL3JhdyIpOwoKICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgZmlsZXMgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgZmlsZXNbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldOwogIH0KCiAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMSkgewogICAgdXJsICs9IHJlbW92ZVByZWZpeChmaWxlc1swXSkgKyAnPyc7CiAgfSBlbHNlIHsKICAgIHZhciBhcmcgPSAnJzsKICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlOwogICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOwoKICAgIHRyeSB7CiAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGZpbGVzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkgewogICAgICAgIHZhciBmaWxlID0gX3N0ZXAudmFsdWU7CiAgICAgICAgYXJnICs9IHJlbW92ZVByZWZpeChmaWxlKSArICcsJzsKICAgICAgfQogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTsKICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7CiAgICB9IGZpbmFsbHkgewogICAgICB0cnkgewogICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTsKICAgICAgICB9CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7CiAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBhcmcgPSBhcmcuc3Vic3RyaW5nKDAsIGFyZy5sZW5ndGggLSAxKTsKICAgIGFyZyA9IGVuY29kZVVSSUNvbXBvbmVudChhcmcpOwogICAgdXJsICs9ICIvP2ZpbGVzPSIuY29uY2F0KGFyZywgIiYiKTsKICB9CgogIGlmIChmb3JtYXQgIT09IG51bGwpIHsKICAgIHVybCArPSAiYWxnbz0iLmNvbmNhdChmb3JtYXQsICImIik7CiAgfQoKICB1cmwgKz0gImF1dGg9Ii5jb25jYXQoc3RvcmUuc3RhdGUuand0KTsKICB3aW5kb3cub3Blbih1cmwpOwp9CmV4cG9ydCBmdW5jdGlvbiBwb3N0KF94NykgewogIHJldHVybiBfcG9zdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfcG9zdCgpIHsKICBfcG9zdCA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSh1cmwpIHsKICAgIHZhciBjb250ZW50LAogICAgICAgIG92ZXJ3cml0ZSwKICAgICAgICBvbnVwbG9hZCwKICAgICAgICBfYXJnczUgPSBhcmd1bWVudHM7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb250ZW50ID0gX2FyZ3M1Lmxlbmd0aCA+IDEgJiYgX2FyZ3M1WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczVbMV0gOiAnJzsKICAgICAgICAgICAgb3ZlcndyaXRlID0gX2FyZ3M1Lmxlbmd0aCA+IDIgJiYgX2FyZ3M1WzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczVbMl0gOiBmYWxzZTsKICAgICAgICAgICAgb251cGxvYWQgPSBfYXJnczUubGVuZ3RoID4gMyA/IF9hcmdzNVszXSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgdXJsID0gcmVtb3ZlUHJlZml4KHVybCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICAgICAgICByZXF1ZXN0Lm9wZW4oJ1BPU1QnLCAiIi5jb25jYXQoYmFzZVVSTCwgIi9hcGkvcmVzb3VyY2VzIikuY29uY2F0KHVybCwgIj9vdmVycmlkZT0iKS5jb25jYXQob3ZlcndyaXRlKSwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdYLUF1dGgnLCBzdG9yZS5zdGF0ZS5qd3QpOwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIG9udXBsb2FkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICByZXF1ZXN0LnVwbG9hZC5vbnByb2dyZXNzID0gb251cGxvYWQ7CiAgICAgICAgICAgICAgfSAvLyBTZW5kIGEgbWVzc2FnZSB0byB1c2VyIGJlZm9yZSBjbG9zaW5nIHRoZSB0YWIgZHVyaW5nIGZpbGUgdXBsb2FkCgoKICAgICAgICAgICAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIkZpbGVzIGFyZSBiZWluZyB1cGxvYWRlZC4iOwogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlcXVlc3Quc3RhdHVzKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHJlamVjdChyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIHJlcXVlc3Quc2VuZChjb250ZW50KTsgLy8gVXBsb2FkIGlzIGRvbmUgbm8gbW9yZSBtZXNzYWdlIGJlZm9yZSBjbG9zaW5nIHRoZSB0YWIgCiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IG51bGw7CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU1KTsKICB9KSk7CiAgcmV0dXJuIF9wb3N0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIG1vdmVDb3B5KGl0ZW1zKSB7CiAgdmFyIGNvcHkgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogIHZhciBwcm9taXNlcyA9IFtdOwogIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7CiAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlOwogIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gaXRlbXNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHsKICAgICAgdmFyIGl0ZW0gPSBfc3RlcDIudmFsdWU7CiAgICAgIHZhciBmcm9tID0gcmVtb3ZlUHJlZml4KGl0ZW0uZnJvbSk7CiAgICAgIHZhciB0byA9IGVuY29kZVVSSUNvbXBvbmVudChyZW1vdmVQcmVmaXgoaXRlbS50bykpOwogICAgICB2YXIgdXJsID0gIiIuY29uY2F0KGZyb20sICI/YWN0aW9uPSIpLmNvbmNhdChjb3B5ID8gJ2NvcHknIDogJ3JlbmFtZScsICImZGVzdGluYXRpb249IikuY29uY2F0KHRvKTsKICAgICAgcHJvbWlzZXMucHVzaChyZXNvdXJjZUFjdGlvbih1cmwsICdQQVRDSCcpKTsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7CiAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHsKICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBtb3ZlKGl0ZW1zKSB7CiAgcmV0dXJuIG1vdmVDb3B5KGl0ZW1zKTsKfQpleHBvcnQgZnVuY3Rpb24gY29weShpdGVtcykgewogIHJldHVybiBtb3ZlQ29weShpdGVtcywgdHJ1ZSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGNoZWNrc3VtKF94OCwgX3g5KSB7CiAgcmV0dXJuIF9jaGVja3N1bS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfY2hlY2tzdW0oKSB7CiAgX2NoZWNrc3VtID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KHVybCwgYWxnbykgewogICAgdmFyIGRhdGE7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZUFjdGlvbigiIi5jb25jYXQodXJsLCAiP2NoZWNrc3VtPSIpLmNvbmNhdChhbGdvKSwgJ0dFVCcpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgZGF0YSA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU7CiAgICAgICAgICAgIHJldHVybiBkYXRhLmpzb24oKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IGFsZ287CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDYuc2VudC5jaGVja3N1bXNbX2NvbnRleHQ2LnQwXSk7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNik7CiAgfSkpOwogIHJldHVybiBfY2hlY2tzdW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQ=="},{"version":3,"sources":["/home/lq/ifb/src/eshop/frontend/src/api/files.js"],"names":["fetchURL","removePrefix","baseURL","store","fetch","url","res","status","json","data","isDir","endsWith","items","map","item","index","encodeURIComponent","name","Error","resourceAction","method","content","opts","body","responseText","remove","put","download","format","files","length","arg","file","substring","state","jwt","window","open","post","overwrite","onupload","Promise","resolve","reject","request","XMLHttpRequest","setRequestHeader","upload","onprogress","onbeforeunload","onload","onerror","error","send","finally","moveCopy","copy","promises","from","to","push","all","move","checksum","algo","checksums"],"mappings":"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","sourcesContent":["import { fetchURL, removePrefix } from './utils'\nimport { baseURL } from '@/utils/constants'\nimport store from '@/store'\n\nexport async function fetch (url) {\n  url = removePrefix(url)\n\n  const res = await fetchURL(`/api/resources${url}`, {})\n\n  if (res.status === 200) {\n    let data = await res.json()\n    data.url = `/files${url}`\n\n    if (data.isDir) {\n      if (!data.url.endsWith('/')) data.url += '/'\n      data.items = data.items.map((item, index) => {\n        item.index = index\n        item.url = `${data.url}${encodeURIComponent(item.name)}`\n\n        if (item.isDir) {\n          item.url += '/'\n        }\n\n        return item\n      })\n    }\n\n    return data\n  } else {\n    throw new Error(res.status)\n  }\n}\n\nasync function resourceAction (url, method, content) {\n  url = removePrefix(url)\n\n  let opts = { method }\n\n  if (content) {\n    opts.body = content\n  }\n\n  const res = await fetchURL(`/api/resources${url}`, opts)\n\n  if (res.status !== 200) {\n    throw new Error(res.responseText)\n  } else {\n    return res\n  }\n}\n\nexport async function remove (url) {\n  return resourceAction(url, 'DELETE')\n}\n\nexport async function put (url, content = '') {\n  return resourceAction(url, 'PUT', content)\n}\n\nexport function download (format, ...files) {\n  let url = `${baseURL}/api/raw`\n\n  if (files.length === 1) {\n    url += removePrefix(files[0]) + '?'\n  } else {\n    let arg = ''\n\n    for (let file of files) {\n      arg += removePrefix(file) + ','\n    }\n\n    arg = arg.substring(0, arg.length - 1)\n    arg = encodeURIComponent(arg)\n    url += `/?files=${arg}&`\n  }\n\n  if (format !== null) {\n    url += `algo=${format}&`\n  }\n\n  url += `auth=${store.state.jwt}`\n  window.open(url)\n}\n\nexport async function post (url, content = '', overwrite = false, onupload) {\n  url = removePrefix(url)\n\n  return new Promise((resolve, reject) => {\n    let request = new XMLHttpRequest()\n    request.open('POST', `${baseURL}/api/resources${url}?override=${overwrite}`, true)\n    request.setRequestHeader('X-Auth', store.state.jwt)\n\n    if (typeof onupload === 'function') {\n      request.upload.onprogress = onupload\n    }\n\n    // Send a message to user before closing the tab during file upload\n    window.onbeforeunload = () => \"Files are being uploaded.\"\n\n    request.onload = () => {\n      if (request.status === 200) {\n        resolve(request.responseText)\n      } else if (request.status === 409) {\n        reject(request.status)\n      } else {\n        reject(request.responseText)\n      }\n    }\n\n    request.onerror = (error) => {\n      reject(error)\n    }\n\n    request.send(content)\n    // Upload is done no more message before closing the tab \n  }).finally(() => { window.onbeforeunload = null })\n}\n\nfunction moveCopy (items, copy = false) {\n  let promises = []\n\n  for (let item of items) {\n    const from = removePrefix(item.from)\n    const to = encodeURIComponent(removePrefix(item.to))\n    const url = `${from}?action=${copy ? 'copy' : 'rename'}&destination=${to}`\n    promises.push(resourceAction(url, 'PATCH'))\n  }\n\n  return Promise.all(promises)\n}\n\nexport function move (items) {\n  return moveCopy(items)\n}\n\nexport function copy (items) {\n  return moveCopy(items, true)\n}\n\nexport async function checksum (url, algo) {\n  const data = await resourceAction(`${url}?checksum=${algo}`, 'GET')\n  return (await data.json()).checksums[algo]\n}\n"]}]}